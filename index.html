<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025년 7월 13일 경마 분석 및 예측</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Calm & Focused -->
    <!-- Application Structure Plan: The application is designed as an interactive dashboard. The primary navigation allows users to toggle between "Busan" and "Seoul" racecourses, which is a more intuitive structure than a linear report. This instantly filters the content. Each race is encapsulated in a "card," a modular component that contains all relevant information: race profile, pace analysis, and key predictions. This card-based design is responsive and allows users to quickly scan for races of interest. The core interaction is within the card: instead of static text, users are presented with a chart visualizing the top horse picks and a corresponding list. Clicking a horse reveals its detailed analysis. This on-demand information disclosure prevents overwhelming the user. A "Today's Top Picks" summary at the top provides immediate, high-level insights. This structure transforms a static document into a user-centric tool for exploration and analysis. -->
    <!-- Visualization & Content Choices: 
        - Overall Structure (Goal: Organize): A tabbed/button-based navigation for Busan/Seoul and a grid of cards for each race. Method: JS-driven dynamic rendering of HTML cards into a Tailwind CSS grid. Justification: Superior to linear scrolling for finding specific information.
        - Race Pace (Goal: Inform): An icon (🚀/🐢) next to a text summary. Method: HTML/Unicode. Justification: Provides a quick, scannable visual cue about the race's nature.
        - Recommended Horses (Goal: Compare & Inform): An interactive bar chart (Chart.js) paired with a clickable list. The chart compares the running style of the recommended horses. The list provides names, adds a '승급' (promotion) badge for relevant horses, and allows users to trigger the display of detailed analysis. Method: Chart.js (Canvas) and dynamic JS/HTML. Justification: Visually compares tactics and highlights key status changes (promotion) effectively.
        - Detailed Analysis (Goal: Inform): A hidden text block. Method: HTML/JS (show/hide on click). Justification: Keeps the initial view clean and provides deep information only when requested by the user.
        - Report Summaries (최고 축마/고배당): A prominent summary card. Method: Styled HTML. Justification: Caters to users seeking quick, actionable takeaways.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #F8F7F4;
            color: #3D405B;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 220px;
            max-height: 250px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 250px;
            }
        }
        .nav-btn {
            transition: all 0.3s ease;
        }
        .nav-btn.active {
            background-color: #81B29A;
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .horse-detail-card {
            background-color: #F8F7F4;
            border-left: 4px solid #E07A5F;
        }
        .race-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .race-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        .horse-item.active {
             background-color: #e9ecef;
             font-weight: bold;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-[#3D405B]">2025년 7월 13일 경마 분석 및 예측</h1>
            <p class="text-md text-gray-600 mt-2">데이터 기반 인터랙티브 분석 대시보드</p>
        </header>

        <section id="summary-section" class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
        </section>

        <nav class="flex justify-center mb-8 bg-white rounded-full shadow-sm p-2">
            <button id="btn-busan" class="nav-btn w-1/2 text-center py-3 px-4 rounded-full font-semibold">🐎 부산 경마</button>
            <button id="btn-seoul" class="nav-btn w-1/2 text-center py-3 px-4 rounded-full font-semibold">🗼 서울 경마</button>
        </nav>

        <main id="race-grid" class="grid grid-cols-1 md:grid-cols-1 lg:grid-cols-2 gap-8">
        </main>

    </div>

    <script>
        const raceData = {
            summary: {
                bestBet: {
                    title: "🏆 이날의 최고 축마",
                    race: "부산 제4경주",
                    horse: "8번 마더축제",
                    reason: "부담중량 증가 변수에도 불구, 최근의 압도적인 기량, 정상급 기수와의 호흡, 경쟁마 부재로 인한 전술적 우위를 고려할 때 가장 신뢰도 높은 축마로 판단됩니다."
                },
                highDividend: {
                    title: "💰 최고 고배당 기회",
                    race: "부산 제3경주",
                    reason: "강력한 선행마들의 초반 경합으로 인한 페이스 붕괴 가능성이 매우 높습니다. 이는 5번 밴지 같은 선입마나 4번 파워풀런 같은 복병마에게 절호의 기회를 제공할 것이며, 높은 배당을 기대해 볼 만합니다."
                }
            },
            races: [
                {
                    location: '부산',
                    raceNumber: 3,
                    title: '국산 5등급, 1200M, 핸디캡',
                    pace: '빠름',
                    type: '고배당 가능',
                    analysis: '강력한 선행마인 1번 하늘폭풍과 2번 레이스맨의 치열한 초반 선두 다툼이 예상됩니다. 이는 빠른 페이스로 이어져, 이들의 바로 뒤에서 편안하게 경주를 운영하는 선입마나 막판 강력한 한 발을 보유한 추입마에게 절대적으로 유리한 환경을 조성할 것입니다.',
                    recommendations: [
                        { type: '축마', number: 5, name: '밴지', style: '선입', styleValue: 3, detail: '검증된 기량, 최상위권 기수, 그리고 빠른 페이스에 최적화된 주행 스타일을 갖춘 가장 안정적인 축마감입니다. 직전 경주 종반 600m 기록이 36.0초로 매우 위력적이었습니다.' },
                        { type: '후착', number: 2, name: '레이스맨', style: '선행', styleValue: 4, detail: '강력한 스피드를 보유했으나, 1번 하늘폭풍과의 불가피한 초반 페이스 경쟁이 종반 걸음에 부담으로 작용할 수 있는 점이 최대 변수입니다.' },
                        { type: '후착', number: 7, name: '짝사랑', style: '추입', styleValue: 2, detail: '직전 경주 2위로 상승세를 보였고 52kg의 가벼운 부중과 채상현 기수 기용으로 전력 상승이 기대됩니다. 빠른 페이스의 수혜를 입을 가능성이 높습니다.' },
                        { type: '복병마', number: 4, name: '파워풀런', style: '자유', styleValue: 1, promotion: true, detail: '데뷔전 우승 후 등급과 거리가 모두 상향된 도전입니다. 52kg의 가벼운 부중과 미지의 잠재력을 바탕으로 이변을 일으킬 수 있는 요주의 마필입니다.' }
                    ]
                },
                {
                    location: '부산',
                    raceNumber: 4,
                    title: '국산 5등급, 1400M, 핸디캡',
                    pace: '느림',
                    type: '축마 확실',
                    analysis: '압도적인 선행마가 부재하여 초반 페이스는 느리게 전개될 가능성이 높습니다. 이는 큰 힘을 들이지 않고 선두권에 자리 잡을 수 있는 말들에게 유리하며, 경주의 승패는 직선주로에서의 뒷심 싸움에서 갈릴 전망입니다.',
                    recommendations: [
                        { type: '축마', number: 8, name: '마더축제', style: '선입', styleValue: 3, detail: '최상의 컨디션, 최상급 기수, 그리고 느린 페이스를 지배할 수 있는 전술적 이점까지 겸비한 이번 경주의 가장 확실한 축마입니다. 부담중량 증가(3kg)가 변수지만 충분히 극복 가능합니다.' },
                        { type: '후착', number: 3, name: '팀서프라이즈', style: '추입', styleValue: 2, detail: '현 등급에서 꾸준한 성적을 내고 있으며 종반 걸음이 안정적입니다. 복승식 및 쌍승식의 유력한 후착 후보입니다.' },
                        { type: '후착', number: 10, name: '토함산태양', style: '추입', styleValue: 2, detail: '장거리에서 보여준 상승세가 뚜렷합니다. 단축된 거리에 성공적으로 적응한다면 입상권 진입이 충분히 가능합니다.' },
                        { type: '복병마', number: 5, name: '앨리스마린', style: '선입', styleValue: 3, detail: '직전 경주 2위로 부진에서 탈출했습니다. 1.5kg의 부중 감량과 이효식 기수로의 교체는 무시할 수 없는 변수입니다.' }
                    ]
                },
                {
                    location: '부산',
                    raceNumber: 5,
                    title: '국산 3등급, 1200M, 핸디캡',
                    pace: '빠름',
                    type: '혼전 양상',
                    analysis: '빠른 발을 가진 선행형 마필들이 다수 포진해 초반부터 치열한 경합이 예상됩니다. 매우 빠른 페이스는 선두권 바로 뒤에서 힘을 안배한 선입마나 막판 추입력이 뛰어난 말들에게 유리한 기회를 제공할 것입니다.',
                    recommendations: [
                        { type: '축마', number: 10, name: '유림세상', style: '선입', styleValue: 3, promotion: true, detail: '상승세의 승급마로, 4kg의 부중 감량 이점이 절대적입니다. 빠른 페이스 속에서 선두권 전개가 가능해 가장 유력한 우승 후보입니다.' },
                        { type: '후착', number: 2, name: '넘버원픽', style: '선행', styleValue: 4, detail: '기량은 최상위권이나, 급격히 늘어난 부담중량(4.5kg)이 최대 변수입니다. 극복 여부가 관건입니다.' },
                        { type: '후착', number: 6, name: '서던조이', style: '선입', styleValue: 3, detail: '꾸준한 기량을 보여주는 암말로, 안정적인 선입 전개를 통해 입상권 진입이 가능합니다.' },
                        { type: '복병마', number: 1, name: '골든에어', style: '추입', styleValue: 2, detail: '6kg의 대폭적인 감량 이점을 안고 출전합니다. 다실바 기수와의 호흡을 통해 이변을 노릴 수 있는 요주의 마필입니다.' }
                    ]
                },
                {
                    location: '부산',
                    raceNumber: 6,
                    title: '1등급, 1800M, 핸디캡',
                    pace: '보통',
                    type: '고배당 가능',
                    analysis: '부산 최상위 1등급 경주로, 페이스는 보통 이상으로 형성될 것입니다. 1800m 장거리인 만큼, 무리한 초반 경합보다는 안정적인 페이스 조절이 승패의 관건이 될 것입니다.',
                    recommendations: [
                        { type: '축마', number: 6, name: '영광의퍼스트', style: '추입', styleValue: 2, promotion: true, detail: '강력한 추입력과 3.5kg의 부중 감량 이점을 안고 출전하는 승급마입니다. 1등급에서도 충분히 통할 잠재력을 보유했습니다.' },
                        { type: '후착', number: 4, name: '벌마의몬스터', style: '선입', styleValue: 3, detail: '안정적인 전개 능력과 기수와의 호흡이 강점입니다. 높은 부담중량을 극복하는 것이 관건입니다.' },
                        { type: '후착', number: 5, name: '그레이트위너', style: '선행', styleValue: 4, detail: '최시대 기수와의 호흡을 바탕으로 선행 전개 시 버티는 능력이 탁월합니다.' },
                        { type: '복병마', number: 1, name: '헌터드래곤', style: '추입', styleValue: 2, detail: '6.5kg의 대폭적인 부중 감량 혜택을 받은 마필입니다. 정도윤 기수와의 호흡을 통해 이변을 연출할 가능성이 있습니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 5,
                    title: '국산 5등급, 1400M, 핸디캡',
                    pace: '느림',
                    type: '전술적 퍼즐',
                    analysis: '5번 맥스파티가 유일한 선행마로, 단독 선행으로 나서며 경주 페이스를 느리게 조절할 가능성이 매우 높습니다. 이는 후방 추입마에게는 불리하며, 선두나 선입권에서 경주를 풀어가는 말들에게 절대적으로 유리합니다.',
                    recommendations: [
                        { type: '축마', number: 5, name: '맥스파티', style: '선행', styleValue: 4, detail: '편성상 유일한 선행마로 경주를 지배할 가능성이 높습니다. 부담중량이 변수지만 전술적 이점이 더 큽니다.' },
                        { type: '후착', number: 6, name: '카일리', style: '선입', styleValue: 3, detail: '직전 경주 상승세와 부중 감량 이점을 바탕으로 선입 후 역전을 노릴 유력 후보입니다.' },
                        { type: '후착', number: 4, name: '원더풀테크노', style: '선입', styleValue: 3, detail: '직전 2위로 컨디션이 좋고, 선두권 바로 뒤에 붙어갈 수 있는 전술적 유연성을 갖췄습니다.' },
                        { type: '복병마', number: 7, name: '파워밴드', style: '추입', styleValue: 2, detail: '52kg의 가벼운 부중으로 출전하는 추입마입니다. 페이스가 예상보다 빨라진다면 막판 역습이 가능합니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 6,
                    title: '국산 5등급, 1700M, 핸디캡',
                    pace: '보통',
                    type: '혼전 속 안정감',
                    analysis: '지구력을 시험하는 1700m 장거리 경주입니다. 페이스는 보통 수준으로 흘러갈 전망이며, 3-4코너를 지나 직선주로에서 벌어지는 지구력 싸움으로 결판날 가능성이 높습니다.',
                    recommendations: [
                        { type: '축마', number: 1, name: '월드조이', style: '선입', styleValue: 3, detail: '검증된 장거리 능력과 꾸준한 기량을 바탕으로 가장 안정적인 축마로 평가됩니다.' },
                        { type: '후착', number: 8, name: '블랙사탕', style: '선행', styleValue: 4, promotion: true, detail: '승급전이지만 장거리 우승 경험과 가벼운 부중이 강점입니다. 선행 시 버티는 능력이 관건입니다.' },
                        { type: '후착', number: 2, name: '고스트크리솔', style: '추입', styleValue: 2, detail: '꾸준히 장거리에 도전하며 경험을 쌓고 있으며, 51kg의 최저 부중 이점을 살릴 수 있습니다.' },
                        { type: '복병마', number: 9, name: '태평무', style: '선행', styleValue: 4, detail: '선행 전개 시 의외의 결과를 낼 수 있는 마필로, 컨디션 회복 여부가 관건입니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 7,
                    title: '혼합 4등급, 1800M, 핸디캡',
                    pace: '느림',
                    type: '전술 싸움',
                    analysis: '뚜렷한 선행마가 없는 편성으로 매우 느린 페이스가 예상됩니다. 후방 추입마에게 절대적으로 불리하며, 3-4코너에서 먼저 움직여 선두권에 가담하거나 편안하게 경주를 풀어간 말이 우승할 확률이 높습니다.',
                    recommendations: [
                        { type: '축마', number: 8, name: '창조의아침', style: '선입', styleValue: 3, detail: '꾸준한 장거리 성적과 전술적 유연성을 바탕으로 가장 안정적인 축마감입니다. 느린 페이스에서 선입 전개가 가능해 유리합니다.' },
                        { type: '후착', number: 5, name: '이클립스블랙', style: '추입', styleValue: 2, detail: '가벼운 부중을 앞세워 장거리에서 경쟁력을 보일 유력 후보입니다.' },
                        { type: '후착', number: 2, name: '블랙건', style: '선입', styleValue: 3, detail: '장거리 우승 경험과 가벼운 부중이 강점입니다. 선두권 근접 전개 시 위협적입니다.' },
                        { type: '복병마', number: 1, name: '스카이함성', style: '추입', styleValue: 2, detail: '최근 부진하지만 본래 장거리 능력이 있습니다. 최저 부중인 51kg을 배정받아 이변을 노릴 수 있습니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 8,
                    title: '1등급, 1200M, 핸디캡',
                    pace: '빠름',
                    type: '추입마의 무대',
                    analysis: '최상급 선행마들이 포진해 매우 빠른 페이스가 확실시됩니다. 이들의 치열한 선두 다툼은 후방의 추입마들에게 절호의 기회를 제공할 것이며, 막판 폭발적인 추입력을 가진 말이 유리합니다.',
                    recommendations: [
                        { type: '축마', number: 9, name: '금전사', style: '추입', styleValue: 2, detail: '강력한 추입력, 가벼운 부중, 그리고 그에게 최적화된 빠른 페이스까지 삼박자를 모두 갖춘 유력 우승 후보입니다.' },
                        { type: '후착', number: 10, name: '황금럭키', style: '추입', styleValue: 2, detail: '경험 많은 추입마로, 가벼운 부중을 앞세워 막판 역습을 노릴 것입니다.' },
                        { type: '후착', number: 8, name: '거센반격', style: '선입', styleValue: 3, detail: '안정적인 전개 능력을 바탕으로 입상권 진입을 노릴 수 있는 실력마입니다.' },
                        { type: '복병마', number: 2, name: '섀도헌터', style: '추입', styleValue: 2, promotion: true, detail: '승급전이지만 직전 경주 우승의 기세가 좋고, 빠른 페이스의 수혜를 입을 수 있는 추입형 마필입니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 9,
                    title: '혼합 3등급, 1800M, 핸디캡',
                    pace: '보통',
                    type: '상승세 마필 격돌',
                    analysis: '최근 연승 가도를 달리는 신흥 강자들의 대결 구도입니다. 페이스는 보통 수준으로 예상되며, 힘을 안배하며 직선주로 싸움을 대비하는 양상이 될 것입니다.',
                    recommendations: [
                        { type: '축마', number: 3, name: '파사킹', style: '추입', styleValue: 2, detail: '3연승의 압도적인 기세와 검증된 장거리 추입력을 바탕으로 4연승에 도전하는 가장 강력한 우승 후보입니다.' },
                        { type: '후착', number: 7, name: '스파크선더', style: '선입', styleValue: 3, promotion: true, detail: '상승세의 승급마로, 가벼운 부중을 앞세워 파사킹에 맞설 유력한 대항마입니다.' },
                        { type: '후착', number: 2, name: '글로벌파워', style: '선입', styleValue: 3, detail: '3등급에서 검증된 실력마로, 안정적인 선택지가 될 수 있습니다.' },
                        { type: '복병마', number: 5, name: '엔딩파이어', style: '자유', styleValue: 1, detail: '직전 경주 2위로 컨디션 회복세를 보였고, 문세영 기수와의 호흡이 기대되는 복병입니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 10,
                    title: '2등급, 1800M, 핸디캡',
                    pace: '보통',
                    type: '고배당 가능',
                    analysis: '선행마와 추입마의 극단적인 대결 구도입니다. 1번 금세다가 단독 선행에 나설 경우와 견제를 받을 경우의 결과가 크게 달라질 수 있어 의외의 결과가 나올 수 있는 흥미로운 편성입니다.',
                    recommendations: [
                        { type: '축마', number: 10, name: '그레이트스톰', style: '추입', styleValue: 2, detail: '3연승의 무서운 상승세와 폭발적인 추입력을 바탕으로 2등급 무대에서도 통할 유력 축마입니다.' },
                        { type: '후착', number: 1, name: '금세다', style: '선행', styleValue: 4, detail: '최내측 게이트의 이점을 살려 단독 선행에 성공한다면 종반까지 버틸 가능성이 있습니다.' },
                        { type: '후착', number: 7, name: '콩나물', style: '선입', styleValue: 3, detail: '안정적인 전개 능력과 상승세를 바탕으로 입상권에 도전할 실력마입니다.' },
                        { type: '복병마', number: 9, name: '바이킹하트', style: '자유', styleValue: 1, detail: '2등급 경험이 풍부하고 꾸준한 성적을 내는 마필. 혼전 시 입상 기회를 노릴 수 있습니다.' }
                    ]
                },
                {
                    location: '서울',
                    raceNumber: 11,
                    title: '1등급, 2000M, 핸디캡',
                    pace: '보통',
                    type: '혼전 양상',
                    analysis: '서울 경마의 대미를 장식하는 1등급 2000m 최장거리 경주입니다. 승급마들의 기세와 기존 강자들의 관록이 맞부딪히는 예측불허의 경주로, 승부는 직선주로 지구력 싸움에서 결정될 것입니다.',
                    recommendations: [
                        { type: '축마', number: 5, name: '새내타운', style: '선입', styleValue: 3, promotion: true, detail: '상승세의 승급마로, 52kg의 가벼운 부중을 앞세워 1등급 무대에 도전합니다. 가장 기대치가 높습니다.' },
                        { type: '후착', number: 10, name: '황금럭키', style: '추입', styleValue: 2, detail: '검증된 장거리 능력과 가벼운 부중을 바탕으로 안정적인 입상 후보입니다.' },
                        { type: '후착', number: 2, name: '섀도헌터', style: '추입', styleValue: 2, promotion: true, detail: '역시 상승세의 승급마로, 가벼운 부중을 앞세워 이변을 노릴 수 있습니다.' },
                        { type: '복병마', number: 3, name: '발베니', style: '자유', styleValue: 1, detail: '1등급에서 부진하지만, 본래 가진 기량이 뛰어나 컨디션 회복 시 언제든 입상 가능한 요주의 마필입니다.' }
                    ]
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            const raceGrid = document.getElementById('race-grid');
            const summarySection = document.getElementById('summary-section');
            const btnBusan = document.getElementById('btn-busan');
            const btnSeoul = document.getElementById('btn-seoul');
            const styleMapping = {
                1: '자유',
                2: '추입',
                3: '선입',
                4: '선행'
            };

            function wrapLabel(label) {
                const maxLen = 16;
                if (typeof label !== 'string' || label.length <= maxLen) {
                    return label;
                }
                const words = label.split(' ');
                const lines = [];
                let currentLine = '';
                for (const word of words) {
                    if ((currentLine + word).length > maxLen) {
                        lines.push(currentLine.trim());
                        currentLine = '';
                    }
                    currentLine += word + ' ';
                }
                lines.push(currentLine.trim());
                return lines.filter(line => line.length > 0);
            }

            function createChart(canvasId, race) {
                const ctx = document.getElementById(canvasId).getContext('2d');
                const labels = race.recommendations.map(h => `${h.number} ${h.name}`);
                const data = race.recommendations.map(h => h.styleValue);
                const backgroundColors = race.recommendations.map(h => {
                    if (h.type === '축마') return 'rgba(224, 122, 95, 0.8)'; // terracotta
                    if (h.type === '후착') return 'rgba(129, 178, 154, 0.8)'; // sage green
                    return 'rgba(61, 64, 91, 0.6)'; // dark slate blue
                });

                return new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels.map(wrapLabel),
                        datasets: [{
                            label: '주행 스타일',
                            data: data,
                            backgroundColor: backgroundColors,
                            borderColor: backgroundColors.map(c => c.replace('0.8', '1').replace('0.6','1')),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 4.5,
                                ticks: {
                                    stepSize: 1,
                                    callback: function(value, index, values) {
                                        return styleMapping[value] || '';
                                    }
                                },
                                title: {
                                    display: true,
                                    text: '주행 스타일'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    title: function(tooltipItems) {
                                        const item = tooltipItems[0];
                                        let label = item.chart.data.labels[item.dataIndex];
                                        return Array.isArray(label) ? label.join(' ') : label;
                                    },
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.y !== null) {
                                            label += styleMapping[context.parsed.y];
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            function createRaceCard(race, index) {
                const card = document.createElement('div');
                card.className = 'race-card bg-white rounded-xl shadow-lg p-6 flex flex-col';
                
                const paceIcon = race.pace === '빠름' ? '🚀' : (race.pace === '느림' ? '🐢' : '🏃‍♂️');
                const typeColor = race.type.includes('고배당') || race.type.includes('혼전') ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800';

                card.innerHTML = `
                    <div class="mb-4">
                        <h2 class="text-2xl font-bold text-[#3D405B]">${race.location} 제${race.raceNumber}경주</h2>
                        <p class="text-gray-500">${race.title}</p>
                    </div>
                    <div class="flex items-center space-x-4 mb-4">
                        <span class="text-sm font-semibold py-1 px-3 rounded-full ${typeColor}">${race.type}</span>
                         <span class="text-sm font-semibold py-1 px-3 rounded-full bg-blue-100 text-blue-800">${paceIcon} ${race.pace} 페이스 예상</span>
                    </div>
                    <p class="text-gray-600 mb-4 text-sm">${race.analysis}</p>
                    <div class="flex-grow">
                        <div class="chart-container mb-4">
                            <canvas id="chart-${index}"></canvas>
                        </div>
                    </div>
                    <div class="mt-auto">
                        <h4 class="font-semibold mb-2">추천 마권</h4>
                        <div id="horse-list-${index}" class="space-y-2">
                           ${race.recommendations.map((h, i) => `
                                <div class="horse-item p-3 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors duration-200" data-index="${i}">
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <span class="font-bold ${h.type === '축마' ? 'text-[#E07A5F]' : (h.type === '복병마' ? 'text-blue-600' : '')}">${h.type}</span>
                                            <span class="ml-2">${h.number} ${h.name}</span>
                                            ${h.promotion ? '<span class="ml-2 text-xs font-semibold py-0.5 px-2 rounded-full bg-yellow-200 text-yellow-800">승급</span>' : ''}
                                        </div>
                                    </div>
                                </div>
                                <div id="detail-${index}-${i}" class="horse-detail-card p-4 rounded-lg mt-1 text-sm text-gray-700 hidden">
                                    ${h.detail}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

                raceGrid.appendChild(card);
                
                const chart = createChart(`chart-${index}`, race);
                
                const horseItems = card.querySelectorAll('.horse-item');
                horseItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const horseIndex = item.dataset.index;
                        
                        card.querySelectorAll('.horse-detail-card').forEach(detail => detail.classList.add('hidden'));
                        const detailCard = card.querySelector(`#detail-${index}-${horseIndex}`);

                        const wasActive = item.classList.contains('active');
                        horseItems.forEach(hi => hi.classList.remove('active'));

                        if (!wasActive) {
                            item.classList.add('active');
                            detailCard.classList.remove('hidden');
                        }
                    });
                });
            }
            
            function renderRaces(location) {
                raceGrid.innerHTML = '';
                const filteredRaces = raceData.races.filter(r => r.location === location);
                filteredRaces.forEach((race, index) => createRaceCard(race, `${location}-${index}`));
            }

            function renderSummary() {
                const { bestBet, highDividend } = raceData.summary;
                summarySection.innerHTML = `
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-[#81B29A]">
                        <h3 class="text-xl font-bold mb-2">${bestBet.title}</h3>
                        <p class="font-semibold text-[#3D405B]">${bestBet.race} ${bestBet.horse}</p>
                        <p class="text-sm text-gray-600 mt-2">${bestBet.reason}</p>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-[#E07A5F]">
                        <h3 class="text-xl font-bold mb-2">${highDividend.title}</h3>
                        <p class="font-semibold text-[#3D405B]">${highDividend.race}</p>
                        <p class="text-sm text-gray-600 mt-2">${highDividend.reason}</p>
                    </div>
                `;
            }

            btnBusan.addEventListener('click', () => {
                renderRaces('부산');
                btnBusan.classList.add('active');
                btnSeoul.classList.remove('active');
            });

            btnSeoul.addEventListener('click', () => {
                renderRaces('서울');
                btnSeoul.classList.add('active');
                btnBusan.classList.remove('active');
            });
            
            renderSummary();
            btnBusan.click();
        });

    </script>
</body>
</html>
